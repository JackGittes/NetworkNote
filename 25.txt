计算机网络原理笔记 25
局域网技术（五）
作者：赵明心    日期：2019/03/13

    7、10 BASE 2连接
    10 BASE 2将连接器集成在内部，数据链路层和物理层在一起，类似于今天的有线电视网络。10 BASE 5和2都是总线型连接，相当于跟外面的主干相连，但是这样存在一些问题。T型头位置容易发生松动，同时一条电缆有多个T头，只要其中一个T型头发生故障松动，整个网络都会出现故障，而且不好判定是在哪里出现故障。故障解决比较容易但是定位很困难，进入90年代中后期之后，以太网从总线型拓扑慢慢向星型拓扑转变。

    8、10 BASE T连接
    有一个集线器，集线器有若干个端口，每个端口连接一根双绞线，双绞线连接到各自的主机这样的连接没有共享广播信道那么明显，看似每个部分都有独立的通信线路，但是这主要看集线器部分如何使用这些信号。实际上，多条线路是同时使用的，最左侧有线路信号进来，右侧的所有端口都会有输出，这个过程是不加选择的，虽然每个用户有单独的物理线路，但是使用的时候受到集线器的控制，在同一个时刻，只能有一个会话存在。

    集线器通过多条物理线路连接多个主机，物理上有多个物理线路，实际使用的时候这些线路并非独立使用。要注意交换式以太网和集线器的共享式以太网是有区别的。

    9、集线器
    （1）集线器是使用电子器件来模拟实际电缆的工作，因此整个系统仍然想一个传统的以太网那样运行。
    （2）使用集线器的以太网在逻辑上仍然是一个总线网，各工作站使用的还是CSMA/CD协议，并共享逻辑上的总线。
    （3）集线器很像一个多端口的转发器，工作在物理层

    网卡地址叫物理地址，但不是物理层标志接受对象的，是标志链路层的。不过通常物理层和数据链路层合在一起叫物理网络。如果可以选择性转发端口就成了交换机。

    集线器    ------------------
             |       |        |
            网卡    网卡      网卡
           工作站  工作站     工作站
    
5.3.3   以太网最大作用距离
    以太网的部署距离是用户非常关注的指标，三个核心因素在网络部署的时候很重要，一个是部署距离，第二是传输速率，第三个是造价。局域网是私有网络，必须关注价格问题，有的网络价格性能很好，但是价格昂贵。以太网的部署距离今天而言影响已经不是太大，现在的全双工光纤技术使得用户已经不用太关心用户距离太远导致网络部署不到的问题。

    一般传统以太网中几个核心功能部件之间的转发距离，主网中几个核心部件，有用户主机、两端口中继器，中继器的作用是防止信号长距离传输衰减，信号在中继器处放大整形，延长信号的传输距离。核心就在于主机和转发器。

    还有一个核心概念是网段，标记网段的地方是有主机连接的电缆。以太网中有个经典的5-4-3法则。5是指以太网通过中继器或转发器来延伸网络距离的部分，最多有5段，4代表转发器或放大器最多4个，4个转发或放大才能分五段。而3是指最多有3端可以接主机。接主机网段的距离最大是500米，未连接主机的两个转发器之间的距离可以达到750米，因此最大延伸距离是3000米。

    3000米距离对于部署一个园区范围来说是可以做到的。以太网作用距离只是针对于10M以太网，并非所有的以太网都遵循这个规则。百兆、千兆以太网不适用这个规则。

5.3.4   以太网的冲突示意过程
    以太网的冲突和之前的介质访问控制是很相似的。此处略去一张冲突示意图。

5.3.5   争用期
    争用期有时候也称为信道竞争的安全期，也就是如果站点发送数据时过了争用期还没有冲突，就不会冲突。
    1、最先发送数据帧的站，在发送数据帧后至多经过时间2t(两倍的端到端往返时延)就可知道发送的数据帧是否遭受了碰撞。
    2、以太网的端到端往返时延2t称为争用期，或碰撞窗口
    3、经过争用期这段时间还没有检测到碰撞，才能肯定这次发送不会发生碰撞

    只有争用期概念并不能解决实际问题，还要必须给出变量的实际意义，算法尽管准确但必须要和实际相对应。使用CSMA/CD的都有争用期的概念，这时候需要确定争用期时长。

    以太网争用期
    （1）以太网取51.2us为争用期长度
    （2）对于10Mb/s以太网，在争用期内可发送512 bit，即64字节
    （3）以太网在发送数据时，若前64字节没有发生冲突，则后续的数据就不会发生冲突。

5.3.6   二进制指数后退算法
    1、发生第一次冲突后，各个站点等待0或1个时槽再开始重传
    2、发生第二次冲突后，各个站点随机地选择等待0\1\2或3个时槽再开始重传
    3、第i次冲突后，在0至2^i-1间随机地选择一个等待的时槽数，再开始重传
    4、10次冲突后，选择等待的时槽数固定在0~2^10-1之间
    5、16次冲突后，发送失败，报告上层

    什么时候会超过16次？要注意网络规模是有限制的，实际部署的时候如果超过了最大数量限制，就会出现冲突大量产生的情况。设计的时候，正常范围内共享数目是有限的，当超过此限度就有可能出现冲突过多。另外有一种可能，站点数量没有超过约定，但是站点间距离不满足，例如在50米内接入了3个用户，这也会导致多次冲突发生。这属于网络部署与规划的不合理，不是短时间内发送用户增多。

5.3.7   最短帧长
    1、如果发生冲突，就一定是在发送的前64个字节之内。
    2、由于一检测到冲突就立即中止发送，这时已经发送出去的数据一定小于64字节
    3、以太网规定了最短有效帧长为64字节，凡长度小于64字节的帧都是由于冲突而异常中止的无效帧。