计算机网络原理笔记 12
数据通信技术（四）
作者：赵明心		日期：2019/02/20

时延在不同层次来看是不同的，时延受哪些因素影响呢？
A发送，B接受，起始状态是A发送，终止状态是B接受，从物理层上来看是A发出第一个二进制位作为开始，B接收到最后一个二进制位结束。但是站在数据链路层来说，情况是不一样的，比如当有很多数据发送，很多帧在A的发送队列中进行排队，排在队首的帧也未必能够立即发送。

在数据链路繁忙的情况下，不一定可以即刻进行发送。站在网络层和传输层，情况更加复杂，还会涉及中间节点的转接。

先看前两个时延，排队时延和传播时延，从物理层来看这个时延受到哪些因素的影响？首先可能受到距离影响，除此之外还受到传输介质的影响，这个会影响介质上能够传输的最大速率，称为传播速率。还要注意的是，初始状态是A发送第一个二进制位，现在只考虑到了二进制位在线上的时间，还缺少考虑第一个二进制位开始从A传送到最后一个二进制位离开A，这个时间受到数据长度影响。这里使用的不是传输速率而是传播速率，我们现在使用2x10e8 m/s作为传播速率。还有一个要考虑的是传输速率，例如网卡的速率，传输时延就是第一个二进制位从A传播，再到最后一个二进制位离开A，物理层的总时延等于传输时延加上传输时延。

物理层时延=距离/传播速率+数据长度/传输速率=传播时延+传输时延

站在高层来看，还需要考虑排队时延和访问时延。排队时延就是数据帧在排队（缓冲队列）的时候需要等待的时延，访问时延就是数据帧已经到达队首，这时使用信道需要等待空闲或者取得令牌、授权。处理时延是站在两个链路级角度来看，接收方判定数据是否可接受所需的时间就是处理时间。而站在网络层或者传输层来看，这个传输时延就更为复杂。例如A发送至C时需要转接B，这个时候处理时延还包括了查表与转发的时延。

要注意时延是计算机网络中非常重要的概念，之后在讲解计算机网络性能的时候会经常以时延作为指标。

3.10.1.2  时延带宽积
    1、时延带宽积即传播时延和带宽的乘积：
        时延带宽积=传播时延x带宽
    2、时延带宽积又称为比特长度，即以比特为单位的链路长度

    时延带宽积（比特长度）就是一条物理链路上二进制位如何分布，也即每米有多少二进制位。这是一个在讲解网络的时候也非常常见的一个概念。要注意的是，带宽在计算机网络当中存在二义性，带宽的单位是频率，带宽在通信中是频率范围，而在网络中一般都是bps，宽带网络是高传输速率的网络，窄带网络是低传输速率的网络

3.10.2  误码率
    1、误码率是指传输的数据被传错的概率
    2、按照衡量误码率的基本单位的不同，可分为：
        （1）误比特率
            误比特率=传错的比特数/传输的总比特数
        （2）误帧率
        （3）误分组率
        ....
    注意的，站在不同的层次，关注的误码单位是不同的。但是不管是哪个层次，分子都是传输的出错数量，分母都是传输的总数量。一般所说误码率都是指误比特率。但是站在数据链路层或者网络层等，一般不会关心有多少比特错了。

    在路由器上，日志计算处理的时候一个重要指标是误分组率。影响出错率的原因有很多，从误比特率到误帧率还要考虑到层间接口、协议本身等等。

3.10.3  信息传输速率与码元传输速率
    1、信息传输速率是指每秒传输的编码前的数字数据的二进制位数，单位是比特/秒，即b/s,bps。
        信息传输速率又称为比特率。
    2、计算机网络中，和信息传输速率有同样含义的另一个术语是带宽(bandwidth)
    3、数字数据经过“线路编码后”的传输信号在信道上的传输速率称为码元传输速率，它是指每秒传输的码元数，即每秒钟传输信号变化的次数，单位是波特/秒(baud/s)。

    注意比特率关心的是原始二进制位在编码前的速率，用户关心的也是真正的原始二进制数的传输速率，用户并不关心编码后信息的传输速率。

    二者最本质的区别就是编码前和编码后，信道传输的编码数据速率是波特率。数字数据编码的基带传输，10M以太网中，信号频率在曼彻斯特编码的情况下，实际的信道频率是20M（码元速率）。信道的传输频率和用户能得到的速率之间的关系取决于编码。例如一个系统中使用了8进制，八级分别表示了从000到111，由于使用了八级电平，信号变化频率是10M每秒，那么能达到的位传输速率是多少呢？

    这个时候每变换一次会携带三个二进制位，8进制情况下的位传输速率是30M，因为每变换一次携带三个二进制位。

    波特率和比特率：
    （1）波特率Rb：信号每秒钟变化的次数，也成为调制速率。
    （2）比特率RB：每秒钟传送到的二进制位数。
    一个信号往往可以携带多个二进制位，所以在固定的信息传输速率下，比特率往往大于波特率，换句话说，一个码元可以传输多个比特（bit）
        Rb=RB×log2(V)（V为电平的级数）
        编码效率=Rb/RB
    
    此处需要讲解另外的两个定理，是否可以通过改进编码效率和改变传输技术，无限制提高传输速率？其实不是的。
    （1）早在1924年，奈奎斯特认识到了这个根本性限制，并推导出一个有限带宽无噪声信道的最大数据传输速率表达式。
    （2）奈奎斯特证明：如果一个任意信号通过带宽为H的低通滤波器，那么每秒采样2H就能完整地重现通过这个滤波器的信号。
    （3）1948年，香农进一步把奈奎斯特的结论扩展到随机（动态）噪声影响的信道。

    由于信道带宽不可能无限大，不可能无噪声，因此传输的速率不可能无限制提升。
    奈奎斯特公式：
        C=2Hxlog2(V)
    C：最大数据传输率，单位b/s或bps
    H：带宽，单位Hz
    V：信号电平级

    奈奎斯特定理不仅在于给出了已知信道的最高传输速率，而且在之前讲解模拟数据的数字化处理的时候讲到了采样、量化、编码。我们希望采样的时候频率越快越好，但并不是绝对的越快越好，这个上限就是2倍的带宽，小于2倍带宽会有损失，但是大于2倍带宽不会有更多的收益。

    噪声是现实世界中人为、非人为和系统内、外因素对信息传输造成的影响。噪声可分为系统内和系统外，系统内例如传输介质的特性（随机热运动等），系统外噪声可分为人为与非人为的，例如荧光灯开启的时候产生电流干扰造成其他设备的噪声干扰，非人为的例如宇宙粒子等。

    香农公式（高斯噪声干扰信道）：
        C=Hxlog2(1+S/N)
    C：传输率，单位b/s
    H：带宽，单位Hz
    S/N(dB)信噪比（分贝）的定义：
        S/N(dB)=10xlog10(S/N)
    S：信号功率，N：噪声功率

    奈奎斯特定理说明数据传输速率随编码级数增加而增加，香农定理说明由于噪声的存在，并非采样采样频率和级数提升可以无限提升速率。

3.11    信道复用技术
    1、由于一条传输线路的能力远远超过传输一个用户所需的能力，为了提高线路利用率，经常多个信号同时共用一条物理线路。
    2、常用方法：
        （1）时分复用TDM（Time Division Multiplexing）
        （2）频分复用FDM（Frequency Division Multiplexing）
        （3）波分复用WDM（Wavelength Division Multiplexing）
        （4）码分复用CDM（Code Division Multiplexing）

    ----                                            -----
    ------ MUX ———————— 共享信道 ————————— MUX ----- 
    ----                                            -----
          复用器                         解复用器

    广播电视和电话是典型的多路复用线路。思考一下，广播或者有线电视，传输线路富余的能力是哪一方面的能力呢？传输速率？带宽？广播实际传送的是语音信号，其频率是300~3400Hz，每一路的电台都是这个范围，但是信道带宽宽于这个范围。根据信道富余能力的不同，分为四种复用技术。
    
    每种多路复用最本质区别就在于传输线路的哪方面能力有富余。多路复用技术中需要发送方有复用器，而在接收方有解复用器，最终每个接收结点只接收对自己有用的数据。

3.11.1  时分多路复用技术TDM
    时分多路复用是计算机网络中最常见的复用技术。
    1、当传输介质的位传输率大于单个信号的要求时，为有效的利用传输系统将多个信号同时在一条传输线路上传输的技术叫时分多路复用。
    2、TDM的实现
    （1）传输时将时间分成等长的时间片
    （2）通过时间片轮转的方式将时间片依次分配给指定的信号
    （3）在接收方也通过时间片轮转的方式在指定的时间依次接收指定的信号

    位传输速率富余是什么情况呢？例如信道带宽100M，实际每一路信号只需要20M就足够了，那么传输系统就可以把信道划分成若干个时间片，5个时间片分配给5个信号。发送方每隔一定的时间发送时间片长度的数据，在接收方按照同样间隔时间，从信道接受一个时间片的数据，只要同步足够好，就可以完成接受。

    实际上时间片轮转方法，在宏观上是并行传输，在微观上是串行的。
    在T1网络中，时间片被分成了24个时间片，对于T1网络，同时只能传送24路信号，当第25路信号到达的时候，需要等待。时间片方式的问题是，一个是如果被分配的时间片没有利用，其他信道也无法利用，再者时间片份数确定了以后，多余的信息进来只能进行等待。

    基于这些原因，时分多路复用分为同步和异步TDM，同步多路复用简单说就是时间片是同样的固定分配的。为避免时间片浪费，时间片不是固定分配的，而是按需分配，在某个时刻中ABC都要发送，可以按需要进行分配时间片。但是STDM也存在问题，同步时分多路复用基于轮转，发送方和接收方都很简单，只需要按照固定时间间隔进行发送和接受，在STDM上就不一样了，发送方需要添加额外信息，因为接收方根本无法预计当前是哪路信号。

    接收方根据前面的控制信息判断是否需要由自己接受。TDM的优点是简单，缺点是信道利用率低，接受的用户数有限。
    
    TDM是同步方式，STDM是异步方式，在计算机网络中，提到同步的时候一般都是指固定速率传输，异步一般就是可变速率传输。TDM中每一路信号获得带宽是固定的，但是对于STDM来说，每路信号获得的数量是可变的。当两者进行结合的时候，可以有混合的时分多路复用，数字通信系统具有综合业务能力，一个信道可以具备多种要求的信号。使用同步和异步结合的时候，例如固定时间片组分为4个时间片，第一路固定分配给语音，剩下的几路分配给有需要的信号。





