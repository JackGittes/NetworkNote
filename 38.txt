计算机网络原理笔记 38
广域网技术（六）
作者：赵明心    日期：2019/04/09

6.5.2   X.25层次关系
    1、用户数据在X.25的分组层（相当于网络层）加上X.25的首部控制信息后，就组装成为了X.25分组
    2、在数据链路层使用的是HDLC的一个子集 —— 平衡型链路接入规程LAPB
    3、在分组层DTE和DCE之间可建立多条逻辑信道（0~4095号），使一个DTE同时和网上其他多个DTE建立虚电路并进行通信
    4、X.25还规定了在经常需要进行通信的两个DTE之间可以建立永久虚电路，这些虚电路号以及分组序号等控制信息都写在X.25分组的首部中

6.5.2.1 X.25层次示意

                                          用户数据
  分组层（网络层）             X.25首部      用户数据
  数据链路层     LAPB首部    |<--------- X.25分组 --------->|    LAPB尾部
               |<-----------------------LAPB帧 ---------->|

    在分组层添加了一些X.25的控制信息

6.5.2.2 X.25网与IP网
    1、基于IP协议的因特网是无连接的，只提供尽最大努力交付的数据报服务，无服务质量可言
    2、X.25网是面向连接的，能够提供可靠交付的虚电路服务，能保证服务质量
    3、正因为X.25网能保证服务质量，在二十多年前它曾经是颇受欢迎的一种计算机网络

6.5.2.3 X.25的衰亡
    要注意的是，IP网与25网存在一个本质的区别，25网是客观真实的物理网络，而IP网络不是客观的物理网络，而是一个逻辑网络，IP网络是构架在不同的网络之上，可以构建在广域网上也可以构建在局域网上。

    具体的物理网络有很多种，需要找一个公共的逻辑网络来承载不同的物理网络，这样就产生了IP网与25网的一个很大区别。

    1、到了20世纪90年代，通信技术进步太大
        （1）通信主干线路已经大量使用光纤技术，数据传输质量大大提高使得误码率降低好几个数量级
        （2）25网十分复杂的数据链路层协议和分组层协议已经成为多余的
    2、PC机价格的急剧下降使得无硬盘的哑终端退出了通信市场，这正好符合因特网当初的设计思想，网络应当尽量简单而智能应尽可能放在网络以外的用户端。

    无硬盘的哑终端就是大型机联机系统。哑终端因为没有数据处理能力，所以对通信质量的要求非常高，哑终端无法对错误数据进行检测和恢复。但是PC机则可以具有数据处理能力，使得这种通信质量的可靠性保障更显的多余。

6.6 帧中继FR
    1、在20世纪80年代后期，许多应用都迫切要求增加分组交换服务的速率
    2、帧中继FR（Frame Relay）就是一种支持高速交换的网络体系结构
    3、帧中继在许多方面非常类似于25网络，被称为二代25网络（快速X.25）
    4、今天的数字光纤网比早期的电话网具有更低的误码率，如果减少结点对分组的处理时间，则各分组通过网络的时延亦可减少，提升结点对分组的处理能力。

    传输附件等新的需求在25网上很难满足，25网络经过改造可以提供更大的传输能力。

6.6.1   帧中继减少结点处理时间
    1、帧中继不使用差错恢复和流量控制机制
    2、当帧中继交换机收到一个帧的首部时，只要一查出帧的目的地址就立即进行转发
    3、因此在帧中继网络中，一个帧的处理时间比25网络约减少了一个数量级。相应地，帧中继网络的吞吐量要比25网络提高一个数量级以上

    帧中继减少了可靠性保障工作，类似于以太网的切通式交换。目标地址和源地址控制信息总是放在头部，而除了校验码之外一般都在头部。帧中继直接对头部信息进行路由选择。

6.6.2   帧中继对差错的处理
    1、当检测到有误码时，结点就要立即中止这次传输
    2、如果需要重传出错的帧，则由源站使用高层协议（而不是帧中继协议）请求重传该帧
    3、仅当帧中继网络本身的误码率非常低时，帧中继技术才是可行的。

6.6.3   帧中继使用虚电路
    1、帧中继的逻辑连接的复用和交换都在第二层处理，而不是像X25网络在第三层处理
    2、帧中继网络向上提供面向连接的虚电路服务，虚电路一般分为交换虚电路SVC和永久虚电路PVC两种
    3、帧中继网络通常为相隔较远的一些局域网提供链路层的永久虚电路服务，它的好处是在通信时可省去建立连接的过程
    4、如果有N个路由器需要用帧中继网络进行连接，那么就一共需要有N(N-1)/2条永久虚电路。

    逻辑IP网对于端到端没有距离限制。现实当中，帧中继服务几乎都是永久式虚电路，使用帧中继相当于申请专线。例如一家公司申请西安和北京之间的两个局域网的连接，这个时候可以申请帧中继专线，这就可以保证二者时刻在线，一旦有传输数据的需求就可以立即进行。但是虚电路服务对应的是传统的电信服务。

6.7 异步传递方式 ATM
    1、人们曾经设想过“未来最理想的”一种网络应当是宽带综合业务数字网B-ISDN
    2、B-ISDN采用新的ATM交换技术，这种技术结合了电路交换和分组交换的优点
    3、虽然在B-ISDN并没有成功，但ATM技术还是获得了相当广泛的应用，并在因特网的发展中起到了重要的作用。

    早期的电子设备都是模拟的，80年代开始设备慢慢走向数字化，信息业务也开始进行数字化。今天不仅仅是数字化，而且已经全IP化。全数字化的好处是同一个平台承载不同的业务，从今天来看这个构想基本已经实现了，现在的笔记本电脑已经可以实现几乎绝大多数信息业务，例如电话、电视、通信、数据传输、文献下载，传统信息服务都已经可以完成。

    这里要强调的是信息业务，宽带综合业务主要是涵盖多媒体，B-ISDN当时主要是以来ATM来实现，90年代的时候IP技术和ATM技术有过激烈的竞争，最后以IP技术的胜出而结束，现在ATM已经很少了。注意B-ISDN强调的是以ATM为支撑的综合业务，今天所说的ISDN指的是基于IP网的全业务化。

    今天的因特网可以找到很多ATM技术的踪影，都是经过改造的ATM技术，这个最大的特点是两者逐渐走向融合，ATM是可以对通信质量进行绝对保障的，但是需要付出代价，最明显的就是运营商提供的服务的价格上。IP网络是无保障的，IP网络中所有用户是同等公平竞争的，而ATM网络可以看作是一种贵族化的网络，只要给钱就可以得到保障。

    IP网现在已经不像诞生的时候那么简单了，最简单的就是像拨打电话，这个中间的延迟不能太长，现在的IP网已经可以提供准实时的业务，拨打IP电话相对于文件传输已经算是实时，但是相对于精密机床控制、导弹飞行等等，这些属于真正的实时要求，今天的IP网络再改进也没办法做到毫秒级微秒级的控制，但是人能感受到的误差在秒级，所以对于人的需求来说已经足够了。但是因特网现在不能用来进行精密控制这类应用。

    IP网络借鉴了ATM网络的技术，并不是完全照搬，现在IP网也只是在统计上和概率上保证服务的质量，没有办法做到100%服务质量的保证。

6.7.1   ATM概念
    1、此ATM（Asynchronous Transfer Mode）非彼ATM（Automatic Telling Machine）
    2、ATM是建立在电路交换和分组交换的基础上的一种面向连接的快速分组交换技术
    3、ATM采用定长分组作为传输和交换的单位，这种定长分组叫做信元（cell）

    电路交换和分组交换的综合体就是虚电路，ATM的快速比帧中继还要快，这跟网络结构和帧格式有关系。以后看到信元这个名词，就是ATM技术的内容。信元是固定长度的，分组可以变长可以定长，ATM采用了定长的格式，固定长度是53个字节，这个好处是，排队控制、帧的调度、硬件交换都可以做到，因为帧格式的单一给实现带来了很多好处。信元是可以明确延迟的，在资源调度和延迟控制上会有很大优势，基于硬件的信元交换也很好实现。

6.7.2   “异步”的含义
    1、当用户的ATM信元需要传送时，就可插入到SDH的一个帧中
    2、SDH传送的同步比特流被划分为一个个固定时间长度的帧（请注意，这是时分复用的时间帧，不是数据链路层的帧）
    3、每一个用户发送的ATM信元在每一时分复用帧中的相对位置并不是固定不变的。

    异步在计算机网络中，绝大多数都是异步的，异步就是发送端在发送数据之前不需要跟接受端保持同步，源端和接受端并不是周期性的传输，而是按需传输，可能一段时间很多，可能一段时间没有数据。SDH始终是周期性的传输，没有业务数据的时候，SDH会传输空帧，这样收发双方始终处在同步状态，ATM信元插入到SDH中，就是用SDH帧封装ATM信元，每个帧封装的ATM信元不是固定位置，而是可以在不同的位置，这样就实现了ATM信元的异步。如果严格一样的话就变成同步了。

6.7.3   ATM优点
    1、选择固定长度的短信元作为信息传输的单位，有利于宽带高速交换，信元长度为53个字节，能支持不同速率的各种业务
    2、所有信息以面向连接的方式传送，保持了电路交换在保证实时性和服务质量方面的优点
    3、ATM使用光纤信道传输
        光纤信道的误码率极低，且容量很大，因此在ATM网内不必在数据链路层进行差错控制和流量控制（放在高层处理），提高了信元在网络中的传送速率。

    一开始的时候ATM可以实现622Mbps的传输速率，那时候的以太网只有100Mbps。ATM本身对物理层没有明确要求，也可以使用无线微波传输，但是现实部署的时候没有使用无线微波的。53个字节的信元，头部信息就占据了5个字节，这个控制开销的比例过大。

6.7.4   ATM缺点
    1、ATM信元首部的开销太大
        5字节的信元首部，在53字节的信元中所占的比例相当大
    2、ATM的技术复杂且价格较高
    3、ATM能够直接支持的应用不多
    4、千兆与10千兆以太网的问世，进一步削弱了ATM在因特网高速主干网领域的竞争能力

    ATM有一套非常复杂的流量整形、拥塞控制、用户资源控制的机制，以至于要使用ATM网络，电信运营商的使用人员都需要进行半年以上的培训。技术复杂、使用复杂造成的结果就是用户需要付出昂贵的代价，运营商和技术的成本最直接的结果就是分摊到用户身上。而且价格的昂贵造成相应的网络应用开发很少。

    但是自从千兆以太网出现之后，作为局域网络骨干的作用也被削弱。ATM在高清视频电话会议还有一些政府机关、央企、国企这些对服务质量要求高、对成本不敏感的部门还有使用。

6.7.5   ATM网络中的网络元素
    1、ATM端点（又称为ATM端系统）通过点到点链路与ATM交换机相连
    2、ATM交换机是一个快速分组交换机（交换容量高达数百Gbps），主要构件是：
        （1）交换结构（switching fabric）
        （2）若干个高速输入端口和输出端口
        （3）必要的缓存

6.7.5.1 ATM的交换结构
    

    输入信元------->   ATM交换机 ------->  输出信元
                      交换结构

    ATM照相机、摄像机都属于ATM的接入设备。

6.7.5.2 ATM协议参考模型
    ATM协议参考模型共有三层，大体上与OSI的最低两层相当（但无法严格对应）

    ATM层次
    3           ATM适配层（AAL层）               CS子层/SAR子层

    2             ATM层                         

    1             物理层                        TC子层/PMD子层

6.7.5.3 VCI与VPI
    ATM连接用信元首部中的两极标号来识别
        （1）虚通路标识VCI （Virtual Channel Indentifier）
        （2）虚通道标识符VPI （Virtual Path Indentifier）
    
