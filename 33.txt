计算机网络原理笔记 33
广域网技术（一）
作者：赵明心    日期：2019/04/02

6.0 广域网技术主要内容
    1、路由选择
    2、拥塞控制
    3、网络互联
    4、广域网实例

    广域网没有明确拓扑一般是网状型的，从一个点到另一个点从连通性上来说存在多条通路，而且存在这拥塞的问题。并不是想要发送多少数据网络就可以送出去多少数据，道路上有人的时候，人非常多的话传送数据就会出现拥塞。在通信网络中，有效地传输用户数据就是拥塞控制要解决的问题。
    
    ATM网可以说是局域网技术，也可以说是广域网技术，物理网络可以是局域网也可以是广域网。有的用户直接接在局域网，有的直接接在广域网。不同物理网络，连接在一起的时候需要网络互联技术。广域网实例主要是以ATM网络为基准。

6.1 基本概念
    当主机之间的距离较远时，例如，相隔几十或几百公里，甚至几千公里，局域网显然就无法完成主机之间的通信任务。这时就需要另一种结构的网络，即广域网。

    相距较远的局域网通过路由器与广域网相连组成了一个覆盖范围很广的互联网。

                                互联网

    局域网----路由器或结点交换机------广域网-------路由器或结点交换机-----局域网
      |          结点交换机          |
      |             |              |
     主机            |            主机
                   主机

    在图中给出了不同的网络实例，局域网实例可以直接连接主机，广域网实例的交换节点也可以直接连接主机。互联网的连接对象不是主机而是网络。

    注意，路由器和结点交换机地位是不同的，结点交换机是广域网的内部设备，路由器是局域网和广域网的节点设备，是两者公共的部分。

6.1.1   广域网与互联网的区别
    1、互联网尽管覆盖范围很广，但它不是广域网，它是由多个不同网络构成的，“互连”是其最主要的特征
    2、广域网是单个的网络，它使用结点交换机连接各主机而不是用路由器连接各网络
    3、结点交换机在单个网络中转发分组，而路由器在多个网络构成的互联网中转发分组
    4、连接在一个广域网（或一个局域网）上的主机在该网内进行通信时，只需要使用其网络的物理地址即可。

    互联网距离不一定是广域的。跨网传输必须使用网间设备，例如路由器。ATM网络和以太网的数据传输机理截然不同，无法进行跨网通信。

6.1.2 网路层提供的服务
  1、服务与通信子网技术无关
  2、应该提供面向连接的服务还是无连接的服务
    （1）面向连接的服务（虚电路服务）：传统电信的观点，通信子网应该提供可靠的、面向连接的服务，而将复杂的功能放在网络层（通信子网）
    （2）无连接服务（数据报服务）：Internet观点，通信子网无论怎么设计均不可靠，网络层只需提供无连接服务，而将复杂的功能放在传输层。
    （3）二者本质区别：复杂的差错控制和流量控制放在何处（网络层/传输层）的问题。

    数据报方式和虚电路方式是分组交换的两种具体形式，在网络层提供面向连接的服务称为虚电路服务，面向连接服务和无连接服务与层次是无关的，N层实体可以提供面向连接的，N+1层实体也可以提供面向连接的。N层向N+1层实体提供的服务与N层实体的具体实现是无关的，不管N层实体使用了什么方式，只要N层承诺可以提供这种类型的服务，对于N+1层看来就是一样的。这样实现了将网络实体服务与具体实现分离。

    站在内部角度，即站在N层的角度来说，其实还是有关联的，N层提供的服务和N层使用的具体技术是有关的。例如实现一个学生成绩查询管理的服务，跟采用的编程语言的选择应该是无关的，但是具体实现的时候，采用不同的编程语言，实现的难度是有区别的，使用汇编语言实现这个业务需求是很困难的，但是采用Java语言或者C语言就很容易实现。也就是说内部实现的时候，具体的服务类型和实现是相关的，不过对于外部来说，没有关系。

    注意这里的服务与通信子网技术无关就是这个含义，通信子网无论采用什么技术，只要承诺了可以提供面向连接的服务，上层就认为N层提供的是可靠的有连接服务。

    站在传输服务使用端的用户角度来看，传输服务应该是不可靠的，通信子网提供的传输应该是没有保障的，末端用户需要自己构架一些保障措施，这个时候需要运输层来对网络层进行可靠性加固。如果通信子网提供了可靠的服务，同时用户相信网络层提供的服务足够可靠，那么在传输层就不需要做很多的修正工作。面向连接服务和无连接服务就在于可靠性保障的位置。

    面向连接的服务和无连接的服务没有从根本上解决差错的问题。

  6.1.3 数据报服务的特点
    1、随时接受主机发送的分组（即数据报）
    2、为每个分组独立地选择路由
    3、尽最大努力地将分组交付给目的主机
    4、对源主机没有任何承诺
    5、不能保证所传送的分组不丢失
    6、不能保证按源主机发送分组的先后顺序以及在时限内必须将分组交付给目的主机
    7、当网络发生拥塞时，节点可根据情况丢弃分组
    8、数据报服务实际上是一种“尽力而为”（best effort）的服务

  6.1.4 虚电路连接
    主机H1先向主机H5发出一个特定格式的控制信息分组，要求进行通信，同时寻找一条合适路由，若主机H5同意通信就发回响应，然后双方就建立了虚电路。

    到达目的站的分组顺序就与发送时的顺序一致，因此网络提供虚电路服务对通信的服务质量QoS（Quality of Service）有较好的保证。

    分配专用传输线路，分配专用资源其实是很难保障的。

    数据报服务和虚电路服务的对比

    对比内容                虚电路服务                         数据报服务

    思路              可靠通信应当由网络来保证          可靠通信应当由用户主机保证

    连接建立                  必须有                             不要

    目的站地址        仅在连接建立阶段使用，每个分组     每个分组都有目的站的全地址
                    使用短的虚电路号

    当节点出故障的时候，无连接服务的适应能力更强，因为无连接服务本来就不依赖于上一次的数据传输路径，也就是下一个分组和上一个分组面对的网络情况可以相同也可以不同。

6.2 路由算法
  1、路由算法是网络层软件的重要组成部分
    （1）子网提供数据报服务，每个包都要做路由选择
    （2）子网提供虚电路服务，只需在建立连接时做一次路由选择

  2、路由算法应具有的特性：
    （1）正确性（correctness）
    （2）简单性（simplicity）
    （3）健壮性（robustness：鲁棒性）
    （4）稳定性（stability）
    （5）公平性（fairness）
    （6）最优性（optimality）

  根据子网的类型的不同，路由选择算法的执行次数不同。健壮性（鲁棒性）主要是为了解决网络出现了意外事件的情况，例如网络故障，某个路由器停电，这个时候周边的路由器的路由选择算法应该仍然能够正常工作，而不能出现一个故障，其他的路由选择也出现问题的情况。稳定性则是要求在正常使用的情况下，路由转发算法应当能持续稳定工作。

  公平性要保证不同物理资源使用的频度不能相差太大。这些特征都是路由算法所期待的，但是这些特征当中存在一些有矛盾的特征，简单性存在的时候对于健壮性和稳定性来说是有矛盾的，如果要应对各种可能的意外情况以及维持性能需要，简单性往往不能很好保证，所以最后的最优性是对各个特征的权衡。

6.2.1 路由算法分类
  1、按转发方式和数据副本数量划分
    （1）全路路由算法
      如洪泛算法，按照所有路径广播转发
    （2）多路路由算法
      如选择洪泛算法，向所有接近目的节点的路径转发
    （3）单路路径算法
      如距离矢量算法，向目的节点沿着唯一的路径转发
